<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;400;700;900&family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <title>Amigo Secreto</title>
</head>

<body>
    <main class="main-content">
        <header class="header-banner">
            <h1 class="main-title">Amigo Secreto</h1>
            <img src="assets/amigo-secreto.png" alt="Imagem representativa de amigo secreto">
        </header>
        
        <section class="input-section">
            <h2 class="section-title">Cadastre os Participantes</h2>
            
            <!-- Formul√°rio de cadastro -->
            <div class="form-container">
                <div class="input-wrapper">
                    <div class="input-group">
                        <label for="amigo">Nome do Participante:</label>
                        <input 
                            type="text" 
                            id="amigo" 
                            class="input-name" 
                            placeholder="Digite o nome completo"
                            required
                        >
                    </div>

                    <div class="input-group">
                        <label for="email">E-mail:</label>
                        <input 
                            type="email" 
                            id="email" 
                            class="input-email" 
                            placeholder="Digite o email"
                            required
                        >
                    </div>

                    <button class="button-add" onclick="adicionarAmigo()">
                        <span class="material-icons">add_circle_outline</span>
                        Adicionar
                    </button>
                </div>
            </div>

            <!-- Lista de participantes -->
            <div class="participants-container">
                <h3>Participantes Cadastrados</h3>
                <ul id="listaAmigos" class="name-list" aria-label="Lista de participantes"></ul>
            </div>

            <!-- Bot√µes de a√ß√£o -->
            <div class="button-container">
                <button class="button-draw" onclick="sortearAmigo()">
                    <span class="material-icons">play_circle_outline</span>
                    Realizar Sorteio
                </button>
                
                <button class="button-clear" onclick="limparLista()">
                    <span class="material-icons">clear_all</span>
                    Limpar Lista
                </button>
            </div>

            <!-- Mensagem de resultado -->
            <div class="result-container">
                <ul id="resultado" class="result-list" aria-live="polite"></ul>
            </div>

            <!-- Mensagem de instru√ß√µes -->
            <div class="instructions">
                <p>‚ö†Ô∏è M√≠nimo de 3 participantes para realizar o sorteio</p>
                <p>üìß Cada participante receber√° seu amigo secreto por email</p>
            </div>
        </section>
    </main>

    <!-- Loading overlay -->
    <div id="loading" class="loading-overlay" style="display: none;">
        <div class="loading-spinner"></div>
        <p>Realizando sorteio e enviando emails...</p>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script>
        // Inicializa√ß√£o do EmailJS
        (function() {
            emailjs.init("x6F6Hqmox3IOdPiKg");
        })();

        // Fun√ß√£o para enviar email
        async function enviarEmailAmigoSecreto(emailDestino, nomeRemetente, nomeAmigoSecreto) {
            const templateParams = {
                to_email: emailDestino,        // Email do participante
                to_name: nomeRemetente,        // Nome do participante
                amigo_secreto: nomeAmigoSecreto // Nome do amigo sorteado
            };

            try {
                const response = await emailjs.send(
                    "service_ej6vllq",         // Seu Service ID
                    "template_jrrgokk",        // Seu Template ID
                    templateParams             // Par√¢metros do template
                );

                if (response.status === 200) {
                    console.log(`Email enviado com sucesso para ${emailDestino}`);
                    return true;
                } else {
                    throw new Error(`Falha ao enviar email para ${emailDestino}`);
                }
            } catch (error) {
                console.error(`Erro ao enviar email para ${emailDestino}:`, error);
                return false;
            }
        }
    </script>
    <script src="app.js"></script>
</body>
</html>